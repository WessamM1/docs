---
title: 4. Deploy an Application
---

## [Overview](#overview)

The Control Plane [CLI](/api-reference/cli) offers developers the ability to containerize
their code and push the resulting [image](/api-reference/image) to their [Org's](/api-reference/org) private [image registry](/api-reference/image).
The [image registry](/api-reference/image) is scoped to the [Org](/api-reference/org) and available for use by all [Workloads](/api-reference/workload)
within the [Org](/api-reference/org). Along with the console,
the [CLI](/api-reference/cli) can be used to deploy the [image](/api-reference/image) to the cloud by
configuring a [GVC](/api-reference/gvc) and [Workload](/api-reference/workload).

This quick start will demonstrate how to:

- Containerize a Node.js application.
- Configure a [GVC](/api-reference/gvc) and [Workload](/api-reference/workload) using the [CLI](/api-reference/cli).
- Test the deployed application.

## [Prerequisites](#prerequisites)

- Install the [CLI](/api-reference/cli#install-npm).
- Log in to the [CLI](/api-reference/cli#login).
- Install [Docker](https://www.docker.com/get-started).
- Install [Node.js](https://nodejs.org/en/download/) version 12+.
- Download sample application: 
  - [macOS / Linux](/files/cpln_app.tgz)
  - [Windows](/files/cpln_app.zip)

## [Step One - Containerize the Sample Application](#step-1)

1. Decompress the sample application to a new directory. The application is a web app that will display the environment
   variables of the running process and includes Control Plane variables such as cloud provider and location.

<Tip>
- Decompression helper commands:

  | OS                         | Command                                  |
  | -------------------------- | ---------------------------------------- |
  | macOS                      | gunzip cpln_app.tgz && open cpln_app.tar |
  | Linux                      | tar -xvf cpln_app.tgz                    |
  | Windows 10/11 (PowerShell) | Expand-Archive cpln_app.zip              |
</Tip>

2. Execute the following command from the `cpln_app` directory to containerize the application:

<Note>
Substitute ORG_NAME with the name of your [Org](/api-reference/org). If you have already set a default [Org](/api-reference/org)
in your [profile](guides/manage-profile), you can omit the --org flag.
</Note>

```bash
cpln image build --name quick-start-4:0.1 --push --org ORG_NAME
```

This command will containerize the application locally using Docker and push the [image](/api-reference/image) to your [Org's](/api-reference/org) private [image registry](/api-reference/image).
The [image](/api-reference/image) name will be `quick-start-4` and the tag is `0.1`. You can build and push multiple versions with the same name and
different tags (e.g., 0.2, 0.3, etc.).

<Tip>
Notice that the application doesn't contain a `Dockerfile`. The `cpln image build` command uses [Buildpacks](https://buildpacks.io/)
to scan the application and automatically build the [image](/api-reference/image). If your application has an existing `Dockerfile`,
the command will use that file to containerize the application.
</Tip>

Review the [Push an Image](guides/push-image) guide for additional details.

## [Step Two - Configure a GVC](#step-2)

In this step, you will configure a new [GVC](/api-reference/gvc) for the application using the [CLI](/api-reference/cli). If you'd like to use the [GVC](/api-reference/gvc) created
in the previous [quick start](/sample-application), skip to [step 3](#step-3).

Execute the following command to create a new [GVC](/api-reference/gvc) mapped to two different cloud providers/locations:

```bash
cpln gvc create --name quick-start-4 --location aws-us-west-2 --location gcp-us-east1 --org ORG_NAME
```

The output from this command will show the new [GVC](/api-reference/gvc) and its associated [locations](/api-reference/location).

<Tip>
To view the list of available locations, execute the command: `cpln location get --org ORG_NAME`.
</Tip>

Review the [Create a GVC](guides/create-gvc) guide for additional details.

## [Step Three - Configure a Workload](#step-3)

In this step, you will configure a new [Workload](/api-reference/workload) for the application.

Execute the following command to create a new [Workload](/api-reference/workload).

For the `--name` flag, choose an appropriate name for the workload. It will be used when generating the endpoint URL.

For the `--image` flag, use the name of the [image](/api-reference/image) that was created in [step 1](#step-1). Prefix the [image](/api-reference/image) name with `//image/`
to have the platform pull the [image](/api-reference/image) from your [Org's](/api-reference/org) private registry.

For the `--gvc` flag, use the [GVC](/api-reference/gvc) name created in [step 2](#step-2) or from the previous [quick start](/sample-application).

For the `--port` flag, use port 8080 which is the port the application exposes.

The command uses the `--public` flag which will automatically set the [firewall rules](/api-reference/workload#firewall)
for this [Workload](/api-reference/workload) to allow inbound and outbound Internet traffic.

```bash
cpln workload create --name show-env-variables --image //image/quick-start-4:0.1 --port 8080 --public --gvc quick-start-4 --org ORG_NAME
```

The output from this command will show the new [Workload](/api-reference/workload) name and the endpoint URL. The endpoint is using the
domain name that is set on the [GVC](/api-reference/gvc). Notice that the URL is HTTPS. A TLS certificate
was generated and configured for the endpoint. The platform automatically performs TLS termination and
port translation from 443 to 8080.

Review the [Create a Workload](guides/create-workload) and [Workload Reference](/api-reference/workload) guide for additional details.

## [Step Four - Test the Deployed Application](#step-4)

Allow a few minutes for the workload to deploy, then copy the endpoint URL and paste it into a browser. The output will display the
environment variables for the running process. The variables that are prefixed with `CPLN_` are added by Control Plane and can be
used by your application.

For example, the variable `CPLN_LOCATION` will be the location where the [Workload](/api-reference/workload) was served from. Since we configured the [GVC](/api-reference/gvc) with two
locations, this variable can change depending on the location of the caller since the endpoint URL is DNS geo-routed to the nearest
healthy location.

For more details on the built-in variables, visit the [Workload Environment Variables](/api-reference/workload#environment-variables) reference page.

## [Summary](#summary)

This quick start demonstrated how to deploy an application, from code to a deployed [Workload](/api-reference/workload), in just a couple of steps. The sample application targeted Node.js, but
you can deploy any language that can be containerized (e.g., Java, .NET, Go, etc.).

In the previous [quick start](/sample-application), you used the console to deploy an application, here you exercised the [CLI](/api-reference/cli) to perform similar actions. All
Control Plane resources, such as [GVCs](/api-reference/gvc) and [Workloads](/api-reference/workload), can be created/modified either using the console or the [CLI](/api-reference/cli).
